<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics Demo - GestureQuiz</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            max-width: 800px;
            margin: 30px auto;
            padding: 20px;
            background-color: #f8fafc;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            color: #2563eb;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .demo-section {
            background: #f3f4f6;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #2563eb;
        }
        
        .btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
            display: inline-block;
            text-decoration: none;
            text-align: center;
        }
        
        .btn:hover {
            background: #1d4ed8;
        }
        
        .btn-success {
            background: #10b981;
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .step {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }
        
        .step h3 {
            color: #1f2937;
            margin-top: 0;
        }
        
        .feature-list {
            background: #ecfdf5;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #10b981;
        }
        
        .feature-list ul {
            margin: 10px 0;
        }
        
        .feature-list li {
            margin: 8px 0;
        }
        
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .status-ready {
            background: #dcfce7;
            color: #166534;
        }
        
        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š Analytics Feature Demo</h1>
        
        <div class="demo-section">
            <h2>ðŸŽ¯ What's New</h2>
            <p>The analytics feature has been fully implemented with professional reporting capabilities for quiz results.</p>
        </div>

        <div class="feature-list">
            <h3>âœ… Features Implemented</h3>
            <ul>
                <li><strong>Overview Dashboard:</strong> Total attempts, average score, highest score, completion rate</li>
                <li><strong>Score Distribution:</strong> Visual bar charts showing performance ranges</li>
                <li><strong>Detailed Results Table:</strong> Individual student scores with sorting</li>
                <li><strong>Performance Insights:</strong> Automated recommendations and analysis</li>
                <li><strong>Export to CSV:</strong> Download quiz results for external analysis</li>
                <li><strong>Responsive Design:</strong> Works on desktop and mobile devices</li>
                <li><strong>Empty State Handling:</strong> Graceful display when no results exist</li>
            </ul>
        </div>

        <div class="step">
            <h3>Step 1: Set Up Test Data</h3>
            <p>Add sample quiz and results data to demonstrate the analytics feature.</p>
            <button class="btn" onclick="addTestData()">Add Test Data</button>
            <span id="dataStatus" class="status status-pending">No test data</span>
        </div>

        <div class="step">
            <h3>Step 2: View Analytics</h3>
            <p>Go to quiz management and click "View Report" on the JavaScript Fundamentals quiz.</p>
            <a href="pages/quiz-management.html" class="btn btn-success">Open Quiz Management</a>
        </div>

        <div class="step">
            <h3>Step 3: Explore Features</h3>
            <p>In the analytics modal, explore:</p>
            <ul>
                <li><strong>Overview Tab:</strong> See summary statistics and score distribution</li>
                <li><strong>Results Tab:</strong> View detailed student results and export CSV</li>
                <li><strong>Performance Tab:</strong> Get insights and recommendations</li>
            </ul>
        </div>

        <div class="demo-section">
            <h3>ðŸ”§ Technical Details</h3>
            <p><strong>Data Structure:</strong> Quiz results stored in localStorage with comprehensive metadata</p>
            <p><strong>Analytics Calculations:</strong> Real-time computation of statistics and distributions</p>
            <p><strong>Export Functionality:</strong> CSV generation with proper formatting</p>
            <p><strong>Responsive Design:</strong> Mobile-friendly modal and charts</p>
        </div>

        <div class="step">
            <h3>Reset Environment</h3>
            <p>Clear all test data to start fresh.</p>
            <button class="btn" onclick="clearData()" style="background: #dc2626;">Clear All Data</button>
        </div>
    </div>

    <script>
        // Check if test data exists
        function checkTestData() {
            const quizzes = JSON.parse(localStorage.getItem('gestureQuizzes') || '[]');
            const results = JSON.parse(localStorage.getItem('quizResults') || '[]');
            const hasTestQuiz = quizzes.some(q => q.id === 1234567890);
            const hasTestResults = results.some(r => r.quizId === 1234567890);
            
            const statusEl = document.getElementById('dataStatus');
            if (hasTestQuiz && hasTestResults) {
                statusEl.textContent = 'Test data ready';
                statusEl.className = 'status status-ready';
            } else {
                statusEl.textContent = 'No test data';
                statusEl.className = 'status status-pending';
            }
        }

        function addTestData() {
            // Create test quiz
            const testQuiz = {
                id: 1234567890,
                title: "JavaScript Fundamentals",
                description: "Test your knowledge of JavaScript basics - Demo Quiz",
                questions: [
                    {
                        id: 1,
                        question: "What is the correct way to declare a variable in JavaScript?",
                        choices: ["var x = 5", "let x = 5", "const x = 5", "All of the above"],
                        correct: 3,
                        gesture: "peace"
                    },
                    {
                        id: 2,
                        question: "Which method is used to add an element to the end of an array?",
                        choices: ["push()", "pop()", "shift()", "unshift()"],
                        correct: 0,
                        gesture: "thumbs-up"
                    },
                    {
                        id: 3,
                        question: "What does '===' operator do in JavaScript?",
                        choices: ["Assignment", "Comparison", "Strict equality", "Logical AND"],
                        correct: 2,
                        gesture: "ok"
                    },
                    {
                        id: 4,
                        question: "Which of the following is not a JavaScript data type?",
                        choices: ["String", "Boolean", "Float", "Object"],
                        correct: 2,
                        gesture: "point"
                    },
                    {
                        id: 5,
                        question: "What is the output of 'typeof null' in JavaScript?",
                        choices: ["null", "undefined", "object", "boolean"],
                        correct: 2,
                        gesture: "fist"
                    }
                ],
                category: "Programming",
                createdAt: new Date().toISOString(),
                status: "published",
                published: true,
                publishedAt: new Date().toISOString()
            };

            // Add the test quiz
            const quizzes = JSON.parse(localStorage.getItem('gestureQuizzes') || '[]');
            const existingQuizIndex = quizzes.findIndex(q => q.id === testQuiz.id);
            if (existingQuizIndex >= 0) {
                quizzes[existingQuizIndex] = testQuiz;
            } else {
                quizzes.push(testQuiz);
            }
            localStorage.setItem('gestureQuizzes', JSON.stringify(quizzes));

            // Create diverse sample results
            const sampleResults = [
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "alice.johnson@university.edu",
                    score: 100,
                    totalQuestions: 5,
                    correctAnswers: 5,
                    completedAt: new Date(Date.now() - 86400000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "bob.smith@university.edu",
                    score: 80,
                    totalQuestions: 5,
                    correctAnswers: 4,
                    completedAt: new Date(Date.now() - 172800000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "charlie.brown@university.edu",
                    score: 60,
                    totalQuestions: 5,
                    correctAnswers: 3,
                    completedAt: new Date(Date.now() - 259200000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "diana.prince@university.edu",
                    score: 40,
                    totalQuestions: 5,
                    correctAnswers: 2,
                    completedAt: new Date(Date.now() - 345600000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "eve.garcia@university.edu",
                    score: 100,
                    totalQuestions: 5,
                    correctAnswers: 5,
                    completedAt: new Date(Date.now() - 432000000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "frank.miller@university.edu",
                    score: 80,
                    totalQuestions: 5,
                    correctAnswers: 4,
                    completedAt: new Date(Date.now() - 518400000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "grace.lee@university.edu",
                    score: 100,
                    totalQuestions: 5,
                    correctAnswers: 5,
                    completedAt: new Date(Date.now() - 604800000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "henry.davis@university.edu",
                    score: 80,
                    totalQuestions: 5,
                    correctAnswers: 4,
                    completedAt: new Date(Date.now() - 691200000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "iris.chen@university.edu",
                    score: 60,
                    totalQuestions: 5,
                    correctAnswers: 3,
                    completedAt: new Date(Date.now() - 777600000).toISOString()
                },
                {
                    quizId: 1234567890,
                    quizTitle: "JavaScript Fundamentals",
                    userEmail: "jack.wilson@university.edu",
                    score: 80,
                    totalQuestions: 5,
                    correctAnswers: 4,
                    completedAt: new Date(Date.now() - 864000000).toISOString()
                }
            ];

            // Replace existing results for this quiz
            const existingResults = JSON.parse(localStorage.getItem('quizResults') || '[]');
            const filteredResults = existingResults.filter(r => r.quizId !== 1234567890);
            const newResults = [...filteredResults, ...sampleResults];
            localStorage.setItem('quizResults', JSON.stringify(newResults));

            // Set up test teacher account
            const testTeacher = {
                name: "Test Teacher",
                email: "teacher@university.edu",
                role: "teacher"
            };
            localStorage.setItem('currentUser', JSON.stringify(testTeacher));

            alert('âœ… Test data added successfully!\n\n' +
                  'â€¢ Quiz: JavaScript Fundamentals\n' +
                  'â€¢ Results: 10 student attempts\n' +
                  'â€¢ Score distribution: 40% to 100%\n' +
                  'â€¢ Teacher account: teacher@university.edu');
            
            checkTestData();
        }

        function clearData() {
            if (confirm('Are you sure you want to clear all quiz data? This cannot be undone.')) {
                localStorage.removeItem('gestureQuizzes');
                localStorage.removeItem('quizResults');
                localStorage.removeItem('currentUser');
                localStorage.removeItem('currentAnalyticsQuizId');
                alert('All data cleared successfully!');
                checkTestData();
            }
        }

        // Check test data status on page load
        document.addEventListener('DOMContentLoaded', checkTestData);
    </script>
</body>
</html>
