<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Test Accounts - GestureQuiz</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-600: #0284c7;
            --primary-700: #0369a1;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --danger-500: #ef4444;
            --danger-600: #dc2626;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --neutral-100: #f5f5f5;
            --neutral-200: #e5e5e5;
            --neutral-600: #525252;
            --neutral-800: #262626;
            --neutral-900: #171717;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #f5f3ff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        .status-section {
            background: #f8fafc;
            border: 1px solid var(--neutral-200);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .status-online {
            background: var(--success-500);
        }

        .status-offline {
            background: var(--danger-500);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid var(--neutral-200);
            margin-bottom: 30px;
        }

        .tab {
            padding: 15px 25px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--neutral-600);
            transition: all 0.3s ease;
        }

        .tab.active {
            color: var(--primary-600);
            border-bottom: 2px solid var(--primary-600);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 30px;
        }

        .form-section {
            background: #f8fafc;
            border: 1px solid var(--neutral-200);
            border-radius: 10px;
            padding: 25px;
        }

        .form-section h3 {
            color: var(--neutral-900);
            margin-bottom: 20px;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--neutral-800);
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--neutral-200);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--primary-600);
            box-shadow: 0 0 0 3px rgba(2, 132, 199, 0.1);
        }

        .avatar-selector {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 8px;
            margin-top: 10px;
        }

        .avatar-option {
            width: 40px;
            height: 40px;
            border: 2px solid var(--neutral-200);
            border-radius: 50%;
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }

        .avatar-option:hover {
            border-color: var(--primary-600);
            transform: scale(1.1);
        }

        .avatar-option.selected {
            border-color: var(--primary-600);
            background: var(--primary-600);
            color: white;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: var(--primary-600);
            color: white;
        }

        .btn-primary:hover {
            background: var(--primary-700);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-500);
            color: white;
        }

        .btn-success:hover {
            background: var(--success-600);
            transform: translateY(-2px);
        }

        .btn-danger {
            background: var(--danger-500);
            color: white;
        }

        .btn-danger:hover {
            background: var(--danger-600);
            transform: translateY(-2px);
        }

        .btn-outline {
            background: white;
            color: var(--primary-600);
            border: 2px solid var(--primary-600);
        }

        .btn-outline:hover {
            background: var(--primary-600);
            color: white;
        }

        .btn-full {
            width: 100%;
            justify-content: center;
        }

        .accounts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .account-card {
            background: white;
            border: 1px solid var(--neutral-200);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .account-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .account-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--neutral-100);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .account-info h4 {
            margin: 0 0 5px 0;
            color: var(--neutral-900);
        }

        .account-info p {
            margin: 0;
            color: var(--neutral-600);
            font-size: 0.9rem;
        }

        .account-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .log-section {
            background: #f8fafc;
            border: 1px solid var(--neutral-200);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            max-height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            margin: 5px 0;
            padding: 8px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.9rem;
        }

        .log-success {
            background: #f0fdf4;
            color: #166534;
            border-left: 4px solid var(--success-500);
        }

        .log-error {
            background: #fef2f2;
            color: #dc2626;
            border-left: 4px solid var(--danger-500);
        }

        .log-info {
            background: #f0f9ff;
            color: #0c4a6e;
            border-left: 4px solid var(--primary-600);
        }

        .log-warning {
            background: #fffbeb;
            color: #92400e;
            border-left: 4px solid var(--warning-500);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }

        .notification.success {
            background: var(--success-500);
        }

        .notification.error {
            background: var(--danger-500);
        }

        .notification.info {
            background: var(--primary-600);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .quick-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-bottom: 30px;
        }

        .role-badge {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .role-teacher {
            background: var(--primary-600);
            color: white;
        }

        .role-student {
            background: var(--success-500);
            color: white;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid var(--neutral-200);
            border-radius: 50%;
            border-top-color: var(--primary-600);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-users"></i> Account Creation & Testing</h1>
            <p>Create and manage test accounts for the GestureQuiz platform</p>
        </div>

        <div class="main-content">
            <!-- Firebase Status -->
            <div class="status-section">
                <div class="status-indicator" id="statusIndicator"></div>
                <div>
                    <strong>Firebase Status:</strong> 
                    <span id="firebaseStatus">Connecting...</span>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <button class="btn btn-success" onclick="createDefaultAccounts()">
                    <i class="fas fa-magic"></i> Create Default Test Accounts
                </button>
                <button class="btn btn-outline" onclick="loadExistingAccounts()">
                    <i class="fas fa-refresh"></i> Load Existing Accounts
                </button>
                <button class="btn btn-outline" onclick="testLogin()">
                    <i class="fas fa-sign-in-alt"></i> Test Login
                </button>
                <button class="btn btn-danger" onclick="clearLog()">
                    <i class="fas fa-trash"></i> Clear Log
                </button>
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab active" onclick="showTab('create')">
                    <i class="fas fa-plus"></i> Create Account
                </button>
                <button class="tab" onclick="showTab('manage')">
                    <i class="fas fa-users"></i> Manage Accounts
                </button>
                <button class="tab" onclick="showTab('test')">
                    <i class="fas fa-flask"></i> Test Authentication
                </button>
            </div>

            <!-- Create Account Tab -->
            <div id="create-tab" class="tab-content active">
                <div class="form-grid">
                    <!-- Teacher Account Form -->
                    <div class="form-section">
                        <h3><i class="fas fa-chalkboard-teacher"></i> Create Teacher Account</h3>
                        <form id="teacherForm">
                            <div class="form-group">
                                <label for="teacherEmail">Email Address</label>
                                <input type="email" id="teacherEmail" placeholder="teacher@example.com" required>
                            </div>
                            <div class="form-group">
                                <label for="teacherPassword">Password</label>
                                <input type="password" id="teacherPassword" placeholder="Enter password" required>
                            </div>
                            <div class="form-group">
                                <label for="teacherName">Full Name</label>
                                <input type="text" id="teacherName" placeholder="Dr. John Smith" required>
                            </div>
                            <div class="form-group">
                                <label for="teacherDepartment">Department</label>
                                <input type="text" id="teacherDepartment" placeholder="Mathematics">
                            </div>
                            <div class="form-group">
                                <label for="teacherBio">Bio</label>
                                <textarea id="teacherBio" placeholder="Professor with 10+ years experience..." rows="3"></textarea>
                            </div>
                            <div class="form-group">
                                <label>Avatar</label>
                                <div class="avatar-selector" id="teacherAvatars">
                                    <div class="avatar-option selected" data-avatar="üë®‚Äçüè´">üë®‚Äçüè´</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüè´">üë©‚Äçüè´</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüè´">üßë‚Äçüè´</div>
                                    <div class="avatar-option" data-avatar="üë®‚Äçüíº">üë®‚Äçüíº</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüíº">üë©‚Äçüíº</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüíº">üßë‚Äçüíº</div>
                                    <div class="avatar-option" data-avatar="üë®‚Äçüéì">üë®‚Äçüéì</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüéì">üë©‚Äçüéì</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüéì">üßë‚Äçüéì</div>
                                    <div class="avatar-option" data-avatar="üë®‚Äçüî¨">üë®‚Äçüî¨</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüî¨">üë©‚Äçüî¨</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüî¨">üßë‚Äçüî¨</div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary btn-full">
                                <i class="fas fa-plus"></i> Create Teacher Account
                            </button>
                        </form>
                    </div>

                    <!-- Student Account Form -->
                    <div class="form-section">
                        <h3><i class="fas fa-user-graduate"></i> Create Student Account</h3>
                        <form id="studentForm">
                            <div class="form-group">
                                <label for="studentEmail">Email Address</label>
                                <input type="email" id="studentEmail" placeholder="student@example.com" required>
                            </div>
                            <div class="form-group">
                                <label for="studentPassword">Password</label>
                                <input type="password" id="studentPassword" placeholder="Enter password" required>
                            </div>
                            <div class="form-group">
                                <label for="studentName">Full Name</label>
                                <input type="text" id="studentName" placeholder="Alice Johnson" required>
                            </div>
                            <div class="form-group">
                                <label for="studentGrade">Grade Level</label>
                                <select id="studentGrade">
                                    <option value="9th Grade">9th Grade</option>
                                    <option value="10th Grade">10th Grade</option>
                                    <option value="11th Grade">11th Grade</option>
                                    <option value="12th Grade">12th Grade</option>
                                    <option value="College">College</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="studentSubjects">Subjects (comma-separated)</label>
                                <input type="text" id="studentSubjects" placeholder="Mathematics, Physics, Chemistry">
                            </div>
                            <div class="form-group">
                                <label>Avatar</label>
                                <div class="avatar-selector" id="studentAvatars">
                                    <div class="avatar-option selected" data-avatar="üë®‚Äçüéì">üë®‚Äçüéì</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüéì">üë©‚Äçüéì</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüéì">üßë‚Äçüéì</div>
                                    <div class="avatar-option" data-avatar="üë®‚Äçüíª">üë®‚Äçüíª</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüíª">üë©‚Äçüíª</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüíª">üßë‚Äçüíª</div>
                                    <div class="avatar-option" data-avatar="üë®‚Äçüé®">üë®‚Äçüé®</div>
                                    <div class="avatar-option" data-avatar="üë©‚Äçüé®">üë©‚Äçüé®</div>
                                    <div class="avatar-option" data-avatar="üßë‚Äçüé®">üßë‚Äçüé®</div>
                                    <div class="avatar-option" data-avatar="üéì">üéì</div>
                                    <div class="avatar-option" data-avatar="üìö">üìö</div>
                                    <div class="avatar-option" data-avatar="‚úèÔ∏è">‚úèÔ∏è</div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-primary btn-full">
                                <i class="fas fa-plus"></i> Create Student Account
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Manage Accounts Tab -->
            <div id="manage-tab" class="tab-content">
                <div class="accounts-grid" id="accountsGrid">
                    <!-- Accounts will be loaded here -->
                </div>
            </div>

            <!-- Test Authentication Tab -->
            <div id="test-tab" class="tab-content">
                <div class="form-grid">
                    <div class="form-section">
                        <h3><i class="fas fa-sign-in-alt"></i> Test Login</h3>
                        <form id="loginForm">
                            <div class="form-group">
                                <label for="testEmail">Email Address</label>
                                <input type="email" id="testEmail" placeholder="Enter email to test" required>
                            </div>
                            <div class="form-group">
                                <label for="testPassword">Password</label>
                                <input type="password" id="testPassword" placeholder="Enter password" required>
                            </div>
                            <button type="submit" class="btn btn-primary btn-full">
                                <i class="fas fa-sign-in-alt"></i> Test Login
                            </button>
                        </form>
                    </div>

                    <div class="form-section">
                        <h3><i class="fas fa-user-check"></i> Current User</h3>
                        <div id="currentUserInfo">
                            <p>No user logged in</p>
                        </div>
                        <button class="btn btn-danger btn-full" onclick="testLogout()">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </div>

            <!-- Activity Log -->
            <div class="log-section">
                <h3><i class="fas fa-list"></i> Activity Log</h3>
                <div id="activityLog">
                    <!-- Log entries will appear here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-storage-compat.js"></script>
    
    <!-- GestureQuiz Scripts -->
    <script src="js/firebase-data-manager.js"></script>
    
    <script>
        let firebaseManager = null;
        let selectedTeacherAvatar = 'üë®‚Äçüè´';
        let selectedStudentAvatar = 'üë®‚Äçüéì';

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', async function() {
            await initializeFirebase();
            setupEventListeners();
        });

        async function initializeFirebase() {
            try {
                firebaseManager = new FirebaseDataManager();
                
                // Wait for initialization
                let attempts = 0;
                while (!firebaseManager.isInitialized && attempts < 50) {
                    await new Promise(resolve => setTimeout(resolve, 100));
                    attempts++;
                }
                
                if (firebaseManager.isInitialized) {
                    updateFirebaseStatus('Connected to Firebase', true);
                    logActivity('Firebase initialized successfully', 'success');
                } else {
                    updateFirebaseStatus('Failed to connect to Firebase', false);
                    logActivity('Firebase initialization failed', 'error');
                }
            } catch (error) {
                updateFirebaseStatus('Firebase connection error', false);
                logActivity(`Firebase error: ${error.message}`, 'error');
            }
        }

        function setupEventListeners() {
            // Avatar selectors
            document.querySelectorAll('#teacherAvatars .avatar-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('#teacherAvatars .avatar-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedTeacherAvatar = this.dataset.avatar;
                });
            });

            document.querySelectorAll('#studentAvatars .avatar-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('#studentAvatars .avatar-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedStudentAvatar = this.dataset.avatar;
                });
            });

            // Form submissions
            document.getElementById('teacherForm').addEventListener('submit', handleTeacherFormSubmit);
            document.getElementById('studentForm').addEventListener('submit', handleStudentFormSubmit);
            document.getElementById('loginForm').addEventListener('submit', handleLoginFormSubmit);
        }

        async function handleTeacherFormSubmit(e) {
            e.preventDefault();
            
            const formData = {
                email: document.getElementById('teacherEmail').value,
                password: document.getElementById('teacherPassword').value,
                name: document.getElementById('teacherName').value,
                department: document.getElementById('teacherDepartment').value,
                bio: document.getElementById('teacherBio').value,
                role: 'teacher',
                avatar: selectedTeacherAvatar,
                classes: [],
                isVerified: true
            };

            await createAccount(formData);
        }

        async function handleStudentFormSubmit(e) {
            e.preventDefault();
            
            const subjects = document.getElementById('studentSubjects').value
                .split(',')
                .map(s => s.trim())
                .filter(s => s);

            const formData = {
                email: document.getElementById('studentEmail').value,
                password: document.getElementById('studentPassword').value,
                name: document.getElementById('studentName').value,
                grade: document.getElementById('studentGrade').value,
                subjects: subjects,
                role: 'student',
                avatar: selectedStudentAvatar,
                enrolledClasses: [],
                isVerified: true
            };

            await createAccount(formData);
        }

        async function handleLoginFormSubmit(e) {
            e.preventDefault();
            
            const email = document.getElementById('testEmail').value;
            const password = document.getElementById('testPassword').value;

            await testLoginWithCredentials(email, password);
        }

        async function createAccount(userData) {
            if (!firebaseManager || !firebaseManager.isInitialized) {
                showNotification('Firebase not initialized', 'error');
                return;
            }

            try {
                logActivity(`Creating ${userData.role} account: ${userData.email}`, 'info');
                
                const result = await firebaseManager.signUp(userData.email, userData.password, userData);
                
                if (result.success) {
                    logActivity(`‚úÖ Account created successfully: ${userData.email}`, 'success');
                    showNotification(`${userData.role} account created successfully!`, 'success');
                    
                    // Clear form
                    if (userData.role === 'teacher') {
                        document.getElementById('teacherForm').reset();
                    } else {
                        document.getElementById('studentForm').reset();
                    }
                    
                    // Sign out after creation
                    await firebaseManager.signOut();
                    
                } else {
                    logActivity(`‚ùå Failed to create account: ${result.error}`, 'error');
                    showNotification(`Failed to create account: ${result.error}`, 'error');
                }
            } catch (error) {
                logActivity(`‚ùå Account creation error: ${error.message}`, 'error');
                showNotification(`Account creation error: ${error.message}`, 'error');
            }
        }

        async function createDefaultAccounts() {
            const defaultAccounts = [
                {
                    email: 'teacher@gesturequiz.com',
                    password: 'password123',
                    name: 'Dr. Sarah Johnson',
                    role: 'teacher',
                    avatar: 'üë©‚Äçüè´',
                    department: 'Mathematics',
                    bio: 'Mathematics Professor with 10+ years of experience',
                    classes: ['Math 101', 'Calculus I', 'Statistics'],
                    isVerified: true
                },
                {
                    email: 'student1@gesturequiz.com',
                    password: 'password123',
                    name: 'Alex Chen',
                    role: 'student',
                    avatar: 'üë®‚Äçüéì',
                    grade: '11th Grade',
                    subjects: ['Mathematics', 'Physics', 'Chemistry'],
                    enrolledClasses: ['Math 101', 'Physics Advanced'],
                    isVerified: true
                },
                {
                    email: 'student2@gesturequiz.com',
                    password: 'password123',
                    name: 'Maria Rodriguez',
                    role: 'student',
                    avatar: 'üë©‚Äçüéì',
                    grade: '12th Grade',
                    subjects: ['Mathematics', 'Biology', 'English'],
                    enrolledClasses: ['Math 101', 'Biology Advanced'],
                    isVerified: true
                }
            ];

            logActivity('Creating default test accounts...', 'info');
            
            for (const account of defaultAccounts) {
                await createAccount(account);
                // Small delay between account creations
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
            
            logActivity('Default accounts creation completed', 'success');
            showNotification('Default test accounts created!', 'success');
        }

        async function testLoginWithCredentials(email, password) {
            if (!firebaseManager || !firebaseManager.isInitialized) {
                showNotification('Firebase not initialized', 'error');
                return;
            }

            try {
                logActivity(`Testing login for: ${email}`, 'info');
                
                const result = await firebaseManager.signIn(email, password);
                
                if (result.success) {
                    logActivity(`‚úÖ Login successful: ${email}`, 'success');
                    showNotification('Login successful!', 'success');
                    
                    // Update current user display
                    updateCurrentUserDisplay(result.user, result.profile);
                    
                } else {
                    logActivity(`‚ùå Login failed: ${result.error}`, 'error');
                    showNotification(`Login failed: ${result.error}`, 'error');
                }
            } catch (error) {
                logActivity(`‚ùå Login error: ${error.message}`, 'error');
                showNotification(`Login error: ${error.message}`, 'error');
            }
        }

        async function testLogin() {
            // Quick test with default teacher account
            await testLoginWithCredentials('teacher@gesturequiz.com', 'password123');
        }

        async function testLogout() {
            if (!firebaseManager) return;

            try {
                await firebaseManager.signOut();
                logActivity('‚úÖ Logout successful', 'success');
                showNotification('Logout successful!', 'success');
                
                // Clear current user display
                document.getElementById('currentUserInfo').innerHTML = '<p>No user logged in</p>';
                
            } catch (error) {
                logActivity(`‚ùå Logout error: ${error.message}`, 'error');
                showNotification(`Logout error: ${error.message}`, 'error');
            }
        }

        function updateCurrentUserDisplay(user, profile) {
            const userInfo = document.getElementById('currentUserInfo');
            if (user && profile) {
                userInfo.innerHTML = `
                    <div class="account-header">
                        <div class="account-avatar">${profile.avatar || 'üë§'}</div>
                        <div class="account-info">
                            <h4>${profile.name}</h4>
                            <p>${user.email}</p>
                            <span class="role-badge role-${profile.role}">${profile.role}</span>
                        </div>
                    </div>
                `;
            } else {
                userInfo.innerHTML = '<p>No user logged in</p>';
            }
        }

        function showTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(tabName + '-tab').classList.add('active');
            event.target.classList.add('active');
        }

        function updateFirebaseStatus(message, isOnline) {
            const statusElement = document.getElementById('firebaseStatus');
            const indicatorElement = document.getElementById('statusIndicator');
            
            statusElement.textContent = message;
            indicatorElement.className = `status-indicator ${isOnline ? 'status-online' : 'status-offline'}`;
        }

        function logActivity(message, type = 'info') {
            const log = document.getElementById('activityLog');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = `${new Date().toLocaleTimeString()} - ${message}`;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function clearLog() {
            document.getElementById('activityLog').innerHTML = '';
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        async function loadExistingAccounts() {
            // This would typically load accounts from Firebase
            // For demo purposes, we'll show the default accounts
            showNotification('Feature coming soon: Load existing accounts', 'info');
            logActivity('Loading existing accounts...', 'info');
        }
    </script>
</body>
</html>
