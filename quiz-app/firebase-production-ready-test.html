<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Production Ready Test - GestureQuiz</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .content {
            padding: 30px;
        }

        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .test-card {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border-left: 6px solid #667eea;
            transition: all 0.3s;
        }

        .test-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        .test-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            display: inline-block;
            margin: 5px 0;
        }

        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .btn {
            display: inline-block;
            padding: 12px 24px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            margin: 5px;
        }

        .btn:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn.success {
            background: #28a745;
        }

        .btn.danger {
            background: #dc3545;
        }

        .btn.warning {
            background: #ffc107;
            color: #212529;
        }

        .results {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 400px;
            overflow-y: auto;
        }

        .config-display {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #667eea;
        }

        .config-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #dee2e6;
        }

        .config-item:last-child {
            border-bottom: none;
        }

        .config-key {
            font-weight: 600;
            color: #667eea;
        }

        .config-value {
            color: #495057;
            font-family: monospace;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        .live-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #28a745;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            border-top: 1px solid #dee2e6;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Firebase Production Ready Test</h1>
            <p>Complete integration verification for GestureQuiz Platform</p>
            <div class="live-indicator"></div>
            <span>Live Production Environment</span>
        </div>

        <div class="content">
            <!-- Project Configuration Display -->
            <div class="config-display">
                <h3>üìã Current Firebase Configuration</h3>
                <div class="config-item">
                    <span class="config-key">Project ID:</span>
                    <span class="config-value">gesturequiz-platform-live</span>
                </div>
                <div class="config-item">
                    <span class="config-key">Auth Domain:</span>
                    <span class="config-value">gesturequiz-platform-live.firebaseapp.com</span>
                </div>
                <div class="config-item">
                    <span class="config-key">Storage Bucket:</span>
                    <span class="config-value">gesturequiz-platform-live.firebasestorage.app</span>
                </div>
                <div class="config-item">
                    <span class="config-key">Environment:</span>
                    <span class="config-value">üî¥ PRODUCTION</span>
                </div>
            </div>

            <!-- Test Grid -->
            <div class="test-grid">
                <div class="test-card">
                    <h3>üî• Firebase Connection</h3>
                    <p>Test basic Firebase SDK initialization and connection</p>
                    <div id="connection-status" class="status info">‚è≥ Not tested</div>
                    <br>
                    <button class="btn" onclick="testFirebaseConnection()">Test Connection</button>
                </div>

                <div class="test-card">
                    <h3>üîê Authentication Service</h3>
                    <p>Test Firebase Auth service availability and functionality</p>
                    <div id="auth-status" class="status info">‚è≥ Not tested</div>
                    <br>
                    <button class="btn" onclick="testAuthService()">Test Auth</button>
                </div>

                <div class="test-card">
                    <h3>üóÑÔ∏è Firestore Database</h3>
                    <p>Test Firestore connection and read/write permissions</p>
                    <div id="firestore-status" class="status info">‚è≥ Not tested</div>
                    <br>
                    <button class="btn" onclick="testFirestoreService()">Test Firestore</button>
                </div>

                <div class="test-card">
                    <h3>üíæ Storage Service</h3>
                    <p>Test Firebase Storage connectivity and upload permissions</p>
                    <div id="storage-status" class="status info">‚è≥ Not tested</div>
                    <br>
                    <button class="btn" onclick="testStorageService()">Test Storage</button>
                </div>

                <div class="test-card">
                    <h3>üë§ User Registration</h3>
                    <p>Test complete user registration flow</p>
                    <div id="registration-status" class="status info">‚è≥ Not tested</div>
                    <br>
                    <button class="btn success" onclick="testUserRegistration()">Test Registration</button>
                </div>

                <div class="test-card">
                    <h3>üîë User Login</h3>
                    <p>Test user authentication and login flow</p>
                    <div id="login-status" class="status info">‚è≥ Not tested</div>
                    <br>
                    <button class="btn" onclick="testUserLogin()">Test Login</button>
                </div>
            </div>

            <!-- Progress Bar -->
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <p id="progress-text">Tests not started</p>

            <!-- Action Buttons -->
            <div style="text-align: center; margin: 30px 0;">
                <button class="btn success" onclick="runAllTests()">üöÄ Run All Tests</button>
                <button class="btn warning" onclick="clearResults()">üßπ Clear Results</button>
                <a href="https://console.firebase.google.com/project/gesturequiz-platform-live" target="_blank" class="btn">üìä Open Firebase Console</a>
            </div>

            <!-- Results Display -->
            <div id="results" class="results" style="display: none;"></div>
        </div>

        <div class="footer">
            <p><strong>GestureQuiz Platform</strong> - Production Environment Testing</p>
            <p>All tests are performed against the live Firebase project</p>
        </div>
    </div>

    <!-- Firebase SDK v8 -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-analytics.js"></script>

    <script>
        // Firebase Configuration - Production
        const firebaseConfig = {
            apiKey: "AIzaSyAt4ByDMxZFT00a-zESwNHS8uv3DY08uhg",
            authDomain: "gesturequiz-platform-live.firebaseapp.com",
            projectId: "gesturequiz-platform-live",
            storageBucket: "gesturequiz-platform-live.firebasestorage.app",
            messagingSenderId: "794242095954",
            appId: "1:794242095954:web:85868edc63c96d37ea388b",
            measurementId: "G-Y7WPTJRVG6"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // Initialize services
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();
        const analytics = firebase.analytics();

        // Test tracking
        let testResults = [];
        let completedTests = 0;
        const totalTests = 6;

        function addResult(message, type = 'info') {
            const resultsDiv = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            
            testResults.push({
                message: logEntry,
                type: type,
                timestamp: timestamp
            });
            
            resultsDiv.innerHTML += `<div style="color: ${getColorForType(type)}">${logEntry}</div>`;
            resultsDiv.style.display = 'block';
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }

        function getColorForType(type) {
            switch(type) {
                case 'success': return '#48bb78';
                case 'error': return '#f56565';
                case 'warning': return '#ed8936';
                case 'info': return '#4299e1';
                default: return '#e2e8f0';
            }
        }

        function updateTestStatus(testId, status, message) {
            const statusElement = document.getElementById(`${testId}-status`);
            statusElement.className = `status ${status}`;
            statusElement.textContent = message;
        }

        function updateProgress() {
            const progressPercent = (completedTests / totalTests) * 100;
            document.getElementById('progress-fill').style.width = `${progressPercent}%`;
            document.getElementById('progress-text').textContent = `${completedTests}/${totalTests} tests completed (${Math.round(progressPercent)}%)`;
        }

        // Test Functions
        async function testFirebaseConnection() {
            addResult('üî• Testing Firebase connection...', 'info');
            try {
                const app = firebase.app();
                updateTestStatus('connection', 'success', '‚úÖ Connected');
                addResult('‚úÖ Firebase SDK initialized successfully', 'success');
                addResult(`üìä Project: ${app.options.projectId}`, 'info');
                completedTests++;
                updateProgress();
            } catch (error) {
                updateTestStatus('connection', 'error', '‚ùå Failed');
                addResult(`‚ùå Firebase connection failed: ${error.message}`, 'error');
                completedTests++;
                updateProgress();
            }
        }

        async function testAuthService() {
            addResult('üîê Testing Firebase Auth service...', 'info');
            try {
                const currentUser = auth.currentUser;
                if (currentUser) {
                    updateTestStatus('auth', 'success', '‚úÖ User logged in');
                    addResult(`‚úÖ Auth service available - User: ${currentUser.email}`, 'success');
                } else {
                    updateTestStatus('auth', 'warning', '‚ö†Ô∏è No user logged in');
                    addResult('‚ö†Ô∏è Auth service available - No user currently logged in', 'warning');
                }
                completedTests++;
                updateProgress();
            } catch (error) {
                updateTestStatus('auth', 'error', '‚ùå Failed');
                addResult(`‚ùå Auth service test failed: ${error.message}`, 'error');
                completedTests++;
                updateProgress();
            }
        }

        async function testFirestoreService() {
            addResult('üóÑÔ∏è Testing Firestore database...', 'info');
            try {
                // Try to read from a test collection
                const testRef = db.collection('test').doc('connection');
                await testRef.get();
                updateTestStatus('firestore', 'success', '‚úÖ Connected');
                addResult('‚úÖ Firestore connection successful', 'success');
                
                // Try to write a test document
                try {
                    await testRef.set({
                        timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                        test: 'connection'
                    });
                    addResult('‚úÖ Firestore write test successful', 'success');
                } catch (writeError) {
                    addResult(`‚ö†Ô∏è Firestore write failed: ${writeError.message}`, 'warning');
                    addResult('üí° This usually means security rules need to be updated', 'info');
                }
                
                completedTests++;
                updateProgress();
            } catch (error) {
                updateTestStatus('firestore', 'error', '‚ùå Failed');
                addResult(`‚ùå Firestore test failed: ${error.message}`, 'error');
                completedTests++;
                updateProgress();
            }
        }

        async function testStorageService() {
            addResult('üíæ Testing Firebase Storage...', 'info');
            try {
                const storageRef = storage.ref();
                await storageRef.child('test/connection.txt').getDownloadURL().catch(() => {
                    // Expected to fail if file doesn't exist
                    return null;
                });
                updateTestStatus('storage', 'success', '‚úÖ Connected');
                addResult('‚úÖ Storage service available', 'success');
                completedTests++;
                updateProgress();
            } catch (error) {
                updateTestStatus('storage', 'error', '‚ùå Failed');
                addResult(`‚ùå Storage test failed: ${error.message}`, 'error');
                completedTests++;
                updateProgress();
            }
        }

        async function testUserRegistration() {
            addResult('üë§ Testing user registration...', 'info');
            const testEmail = `test-${Date.now()}@gesturequiz.com`;
            const testPassword = 'TestPass123!';
            
            try {
                // Create user
                const userCredential = await auth.createUserWithEmailAndPassword(testEmail, testPassword);
                const user = userCredential.user;
                
                addResult(`‚úÖ User created: ${user.email}`, 'success');
                
                // Try to create user document
                try {
                    await db.collection('users').doc(user.uid).set({
                        email: user.email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        displayName: 'Test User',
                        isActive: true
                    });
                    
                    updateTestStatus('registration', 'success', '‚úÖ Complete');
                    addResult('‚úÖ User document created successfully', 'success');
                } catch (docError) {
                    updateTestStatus('registration', 'warning', '‚ö†Ô∏è Partial');
                    addResult(`‚ö†Ô∏è User created but document failed: ${docError.message}`, 'warning');
                }
                
                // Clean up test user
                await user.delete();
                addResult('üßπ Test user cleaned up', 'info');
                
                completedTests++;
                updateProgress();
            } catch (error) {
                updateTestStatus('registration', 'error', '‚ùå Failed');
                addResult(`‚ùå Registration test failed: ${error.message}`, 'error');
                completedTests++;
                updateProgress();
            }
        }

        async function testUserLogin() {
            addResult('üîë Testing user login...', 'info');
            
            if (!auth.currentUser) {
                updateTestStatus('login', 'info', '‚ÑπÔ∏è No user to test');
                addResult('‚ÑπÔ∏è No user currently logged in to test', 'info');
                completedTests++;
                updateProgress();
                return;
            }
            
            try {
                const user = auth.currentUser;
                const token = await user.getIdToken();
                
                updateTestStatus('login', 'success', '‚úÖ Valid session');
                addResult('‚úÖ User session is valid', 'success');
                addResult(`üìß User: ${user.email}`, 'info');
                completedTests++;
                updateProgress();
            } catch (error) {
                updateTestStatus('login', 'error', '‚ùå Failed');
                addResult(`‚ùå Login test failed: ${error.message}`, 'error');
                completedTests++;
                updateProgress();
            }
        }

        async function runAllTests() {
            addResult('üöÄ Starting comprehensive Firebase testing...', 'info');
            completedTests = 0;
            updateProgress();
            
            await testFirebaseConnection();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testAuthService();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testFirestoreService();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testStorageService();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testUserRegistration();
            await new Promise(resolve => setTimeout(resolve, 500));
            
            await testUserLogin();
            
            addResult('üéâ All tests completed!', 'success');
            addResult('üìä Check the status indicators above for results', 'info');
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('results').style.display = 'none';
            testResults = [];
            completedTests = 0;
            updateProgress();
            
            // Reset all status indicators
            const statusElements = document.querySelectorAll('.status');
            statusElements.forEach(el => {
                el.className = 'status info';
                el.textContent = '‚è≥ Not tested';
            });
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            addResult('üéØ Firebase Production Ready Test initialized', 'success');
            addResult('üìã Project: gesturequiz-platform-live', 'info');
            addResult('üî¥ Environment: PRODUCTION', 'warning');
            addResult('‚ñ∂Ô∏è Click "Run All Tests" to start comprehensive testing', 'info');
        });
    </script>
</body>
</html>
