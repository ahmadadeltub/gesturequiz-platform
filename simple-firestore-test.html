<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Firestore Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .output { background: #f5f5f5; padding: 15px; border-radius: 5px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
        .btn { background: #007cba; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; margin: 5px; }
    </style>
</head>
<body>
    <h1>üî¨ Simple Firestore .exists Test</h1>
    <button class="btn" onclick="testFirestoreGet()">Test db.collection().doc().get()</button>
    <div id="output" class="output"></div>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAR0VYpV4GH8xbVqRMKhWqD8_YYgShJz6M",
            authDomain: "gesturequiz-platform-live.firebaseapp.com",
            projectId: "gesturequiz-platform-live",
            storageBucket: "gesturequiz-platform-live.firebasestorage.app",
            messagingSenderId: "381311919972",
            appId: "1:381311919972:web:4ae8a649ae97f8e5f6ae16"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const output = document.getElementById('output');

        function log(message) {
            output.textContent += message + '\n';
            console.log(message);
        }

        async function testFirestoreGet() {
            output.textContent = '';
            log('üöÄ Starting Firestore get() test...\n');

            try {
                // Test with a random document ID
                const testId = 'test-' + Date.now();
                log(`üìÑ Testing with document ID: ${testId}`);
                
                // Create a test document first
                log('üìù Creating test document...');
                await db.collection('users').doc(testId).set({ test: true, created: new Date() });
                log('‚úÖ Test document created\n');

                // Now get the document
                log('üîç Calling db.collection("users").doc(testId).get()...');
                const result = await db.collection('users').doc(testId).get();
                
                log('üìä RESULT ANALYSIS:');
                log(`   result: ${result}`);
                log(`   typeof result: ${typeof result}`);
                log(`   result.constructor.name: ${result?.constructor?.name}`);
                log(`   result instanceof Object: ${result instanceof Object}`);
                
                log('\nüîç CHECKING .exists PROPERTY:');
                log(`   'exists' in result: ${'exists' in result}`);
                log(`   result.hasOwnProperty('exists'): ${result.hasOwnProperty('exists')}`);
                log(`   typeof result.exists: ${typeof result.exists}`);
                log(`   result.exists value: ${result.exists}`);
                
                log('\nüîç CHECKING OTHER PROPERTIES:');
                log(`   result.id: ${result.id}`);
                log(`   typeof result.data: ${typeof result.data}`);
                
                log('\nüß™ TESTING .exists ACCESS:');
                try {
                    const existsValue = result.exists;
                    log(`   ‚úÖ result.exists accessed successfully: ${existsValue}`);
                    
                    if (existsValue) {
                        log(`   ‚úÖ Document exists, data: ${JSON.stringify(result.data())}`);
                    } else {
                        log(`   ‚ö†Ô∏è Document does not exist`);
                    }
                } catch (e) {
                    log(`   ‚ùå Error accessing result.exists: ${e.message}`);
                    log(`   ‚ùå Error type: ${e.constructor.name}`);
                }

                // Clean up
                await db.collection('users').doc(testId).delete();
                log('\n‚úÖ Test completed and cleaned up');

            } catch (error) {
                log(`‚ùå Error in test: ${error.message}`);
                log(`‚ùå Error stack: ${error.stack}`);
            }
        }

        log('‚úÖ Firebase initialized. Click button to test.\n');
    </script>
</body>
</html>
